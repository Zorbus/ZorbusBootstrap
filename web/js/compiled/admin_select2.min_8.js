(function(a){"undefined"==typeof a.fn.each2&&a.fn.extend({each2:function(e){for(var c=a([0]),b=-1,d=this.length;++b<d&&(c.context=c[0]=this[b])&&!1!==e.call(c[0],b,c);){}return this}})})(jQuery);(function(T,R){function Q(f,e){var l=0,i=e.length,g;if("undefined"===typeof f){return -1}if(f.constructor===String){for(;l<i;l+=1){if(0===f.localeCompare(e[l])){return l}}}else{for(;l<i;l+=1){if(g=e[l],g.constructor===String){if(0===g.localeCompare(f)){return l}}else{if(g===f){return l}}}}return -1}function O(f,e){return f===e?!0:f===R||e===R||null===f||null===e?!1:f.constructor===String?0===f.localeCompare(e):e.constructor===String?0===e.localeCompare(f):!1}function t(f,e){var l,i,g;if(null===f||1>f.length){return[]}l=f.split(e);i=0;for(g=l.length;i<g;i+=1){l[i]=T.trim(l[i])}return l}function N(f,e,i){var i=i||R,g;return function(){var l=arguments;window.clearTimeout(g);g=window.setTimeout(function(){e.apply(i,l)},f)}}function P(e){e.preventDefault();e.stopPropagation()}function M(f,e,i){var g=f.toUpperCase().indexOf(e.toUpperCase()),e=e.length;0>g?i.push(f):(i.push(f.substring(0,g)),i.push("<span class='select2-match'>"),i.push(f.substring(g,g+e)),i.push("</span>"),i.push(f.substring(g+e,f.length)))}function K(f){var e,l=0,i=null,g=f.quietMillis||100;return function(m){window.clearTimeout(e);e=window.setTimeout(function(){var q=l+=1,s=f.data,w=f.transport||T.ajax,v=f.traditional||!1,u=f.type||"GET",s=s.call(this,m.term,m.page,m.context);null!==i&&i.abort();i=w.call(null,{url:f.url,dataType:f.dataType,data:s,type:u,traditional:v,success:function(x){q<l||(x=f.results(x,m.page),m.callback(x))}})},g)}}function J(f){var e=f,i,g=function(l){return""+l.text};T.isArray(e)||(g=e.text,T.isFunction(g)||(i=e.text,g=function(l){return l[i]}),e=e.results);return function(l){var s=l.term,q={results:[]},m;if(s===""){l.callback({results:e})}else{m=function(u,x){var w,v,u=u[0];if(u.children){w={};for(v in u){u.hasOwnProperty(v)&&(w[v]=u[v])}w.children=[];T(u.children).each2(function(z,y){m(y,w.children)});w.children.length&&x.push(w)}else{l.matcher(s,g(u))&&x.push(u)}};T(e).each2(function(v,u){m(u,q.results)});l.callback(q)}}}function r(e){return T.isFunction(e)?e:function(f){var i=f.term,g={results:[]};T(e).each(function(){var l=this.text!==R,m=l?this.text:this;if(""===i||f.matcher(i,m)){g.results.push(l?this:{id:this,text:this})}});f.callback(g)}}function p(e){if(T.isFunction(e)){return !0}if(!e){return !1}throw Error("formatterName must be a function or a falsy value")}function n(e){return T.isFunction(e)?e():e}function o(f){var e=0;T.each(f,function(g,i){i.children?e+=o(i.children):e++});return e}function j(x,w,v,u){var s=x,m=!1,q,l,i,g;if(!u.createSearchChoice||!u.tokenSeparators||1>u.tokenSeparators.length){return R}for(;;){m=-1;l=0;for(i=u.tokenSeparators.length;l<i&&!(g=u.tokenSeparators[l],m=x.indexOf(g),0<=m);l++){}if(0>m){break}q=x.substring(0,m);x=x.substring(m+g.length);if(0<q.length&&(q=u.createSearchChoice(q,w),q!==R&&null!==q&&u.id(q)!==R&&null!==u.id(q))){m=!1;l=0;for(i=w.length;l<i;l++){if(O(u.id(q),u.id(w[l]))){m=!0;break}}m||v(q)}}if(0!=s.localeCompare(x)){return x}}function d(f,e){var g=function(){};g.prototype=new f;g.prototype.constructor=g;g.prototype.parent=f.prototype;g.prototype=T.extend(g.prototype,e);return g}if(window.Select2===R){var S,h,b,a,k,L;S={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(e){e=e.which?e.which:e;switch(e){case S.LEFT:case S.RIGHT:case S.UP:case S.DOWN:return !0}return !1},isControl:function(e){switch(e.which){case S.SHIFT:case S.CTRL:case S.ALT:return !0}return e.metaKey?!0:!1},isFunctionKey:function(e){e=e.which?e.which:e;return 112<=e&&123>=e}};var c=1;k=function(){return c++};T(document).delegate("body","mousemove",function(e){T.data(document,"select2-lastpos",{x:e.pageX,y:e.pageY})});T(document).ready(function(){T(document).delegate("body","mousedown touchend",function(f){var e=T(f.target).closest("div.select2-container").get(0),g;e?T(document).find("div.select2-container-active").each(function(){this!==e&&T(this).data("select2").blur()}):(e=T(f.target).closest("div.select2-drop").get(0),T(document).find("div.select2-drop-active").each(function(){this!==e&&T(this).data("select2").blur()}));e=T(f.target);g=e.attr("for");"LABEL"===f.target.tagName&&(g&&0<g.length)&&(e=T("#"+g),e=e.data("select2"),e!==R&&(e.focus(),f.preventDefault()))})});h=d(Object,{bind:function(f){var e=this;return function(){f.apply(e,arguments)}},init:function(g){var e,s;this.opts=g=this.prepareOpts(g);this.id=g.id;g.element.data("select2")!==R&&null!==g.element.data("select2")&&this.destroy();this.enabled=!0;this.container=this.createContainer();this.containerId="s2id_"+(g.element.attr("id")||"autogen"+k());this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1");this.container.attr("id",this.containerId);var q=!1,i;this.body=function(){!1===q&&(i=g.element.closest("body"),q=!0);return i};g.element.attr("class")!==R&&this.container.addClass(g.element.attr("class").replace(/validate\[[\S ]+] ?/,""));this.container.css(n(g.containerCss));this.container.addClass(n(g.containerCssClass));this.opts.element.data("select2",this).hide().before(this.container);this.container.data("select2",this);this.dropdown=this.container.find(".select2-drop");this.dropdown.addClass(n(g.dropdownCssClass));this.dropdown.data("select2",this);this.results=e=this.container.find(".select2-results");this.search=s=this.container.find("input.select2-input");s.attr("tabIndex",this.opts.element.attr("tabIndex"));this.resultsPage=0;this.context=null;this.initContainer();this.initContainerWidth();this.results.bind("mousemove",function(u){var f=T.data(document,"select2-lastpos");(f===R||f.x!==u.pageX||f.y!==u.pageY)&&T(u.target).trigger("mousemove-filtered",u)});this.dropdown.delegate(".select2-results","mousemove-filtered",this.bind(this.highlightUnderEvent));var l=this.results,m=N(80,function(f){l.trigger("scroll-debounced",f)});l.bind("scroll",function(f){0<=Q(f.target,l.get())&&m(f)});this.dropdown.delegate(".select2-results","scroll-debounced",this.bind(this.loadMoreIfNeeded));T.fn.mousewheel&&e.mousewheel(function(f,w,v,u){w=e.scrollTop();0<u&&0>=w-u?(e.scrollTop(0),P(f)):0>u&&e.get(0).scrollHeight-e.scrollTop()+u<=e.height()&&(e.scrollTop(e.get(0).scrollHeight-e.height()),P(f))});s.bind("keydown",function(){T.data(s,"keyup-change-value")===R&&T.data(s,"keyup-change-value",s.val())});s.bind("keyup",function(){var f=T.data(s,"keyup-change-value");f!==R&&s.val()!==f&&(T.removeData(s,"keyup-change-value"),s.trigger("keyup-change"))});s.bind("keyup-change",this.bind(this.updateResults));s.bind("focus",function(){s.addClass("select2-focused");" "===s.val()&&s.val("")});s.bind("blur",function(){s.removeClass("select2-focused")});this.dropdown.delegate(".select2-results","mouseup",this.bind(function(f){0<T(f.target).closest(".select2-result-selectable:not(.select2-disabled)").length?(this.highlightUnderEvent(f),this.selectHighlighted(f)):this.focusSearch();P(f)}));this.dropdown.bind("click mouseup mousedown",function(f){f.stopPropagation()});T.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource());(g.element.is(":disabled")||g.element.is("[readonly='readonly']"))&&this.disable()},destroy:function(){var e=this.opts.element.data("select2");e!==R&&(e.container.remove(),e.dropdown.remove(),e.opts.element.removeData("select2").unbind(".select2").show())},prepareOpts:function(f){var e,i,g;e=f.element;"select"===e.get(0).tagName.toLowerCase()&&(this.select=i=f.element);i&&T.each("id multiple ajax query createSearchChoice initSelection data tags".split(" "),function(){if(this in f){throw Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}});f=T.extend({},{populateResults:function(l,v,s){var m,u=this.opts.id,q=this;m=function(F,E,B){var D,A,C,z,w,y,x;D=0;for(A=F.length;D<A;D=D+1){C=F[D];z=u(C)!==R;w=C.children&&C.children.length>0;y=T("<li></li>");y.addClass("select2-results-dept-"+B);y.addClass("select2-result");y.addClass(z?"select2-result-selectable":"select2-result-unselectable");w&&y.addClass("select2-result-with-children");y.addClass(q.opts.formatResultCssClass(C));z=T("<div></div>");z.addClass("select2-result-label");x=f.formatResult(C,z,s);x!==R&&z.html(q.opts.escapeMarkup(x));y.append(z);if(w){w=T("<ul></ul>");w.addClass("select2-result-sub");m(C.children,w,B+1);y.append(w)}y.data("select2-data",C);E.append(y)}};m(v,l,0)}},T.fn.select2.defaults,f);"function"!==typeof f.id&&(g=f.id,f.id=function(l){return l[g]});if(i){f.query=this.bind(function(l){var v={results:[],more:false},s=l.term,m,u,q;q=function(w,y){var x;if(w.is("option")){l.matcher(s,w.text(),w)&&y.push({id:w.attr("value"),text:w.text(),element:w.get(),css:w.attr("class")})}else{if(w.is("optgroup")){x={text:w.attr("label"),children:[],element:w.get(),css:w.attr("class")};w.children().each2(function(A,z){q(z,x.children)});x.children.length>0&&y.push(x)}}};m=e.children();if(this.getPlaceholder()!==R&&m.length>0){u=m[0];T(u).text()===""&&(m=m.not(u))}m.each2(function(x,w){q(w,v.results)});l.callback(v)}),f.id=function(l){return l.id},f.formatResultCssClass=function(l){return l.css}}else{if(!("query" in f)){if("ajax" in f){if((i=f.element.data("ajax-url"))&&0<i.length){f.ajax.url=i}f.query=K(f.ajax)}else{"data" in f?f.query=J(f.data):"tags" in f&&(f.query=r(f.tags),f.createSearchChoice=function(l){return{id:l,text:l}},f.initSelection=function(l,q){var m=[];T(t(l.val(),f.separator)).each(function(){var s=this,v=this,u=f.tags;T.isFunction(u)&&(u=u());T(u).each(function(){if(O(this.id,s)){v=this.text;return false}});m.push({id:s,text:v})});q(m)})}}}if("function"!==typeof f.query){throw"query function not defined for Select2 "+f.element.attr("id")}return f},monitorSource:function(){this.opts.element.bind("change.select2",this.bind(function(){!0!==this.opts.element.data("select2-change-triggered")&&this.initSelection()}))},triggerChange:function(e){e=e||{};e=T.extend({},e,{type:"change",val:this.val()});this.opts.element.data("select2-change-triggered",!0);this.opts.element.trigger(e);this.opts.element.data("select2-change-triggered",!1);this.opts.element.click();this.opts.blurOnChange&&this.opts.element.blur()},enable:function(){this.enabled||(this.enabled=!0,this.container.removeClass("select2-container-disabled"))},disable:function(){this.enabled&&(this.close(),this.enabled=!1,this.container.addClass("select2-container-disabled"))},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var w=this.container.offset(),v=this.container.outerHeight(),u=this.container.outerWidth(),s=this.dropdown.outerHeight(),l=T(window).scrollTop()+document.documentElement.clientHeight,v=w.top+v,q=w.left,l=v+s<=l,m=w.top-s>=this.body().scrollTop(),i=this.dropdown.hasClass("select2-drop-above"),e;"static"!==this.body().css("position")&&(e=this.body().offset(),v-=e.top,q-=e.left);i?(i=!0,!m&&l&&(i=!1)):(i=!1,!l&&m&&(i=!0));i?(v=w.top-s,this.container.addClass("select2-drop-above"),this.dropdown.addClass("select2-drop-above")):(this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above"));w=T.extend({top:v,left:q,width:u},n(this.opts.dropdownCss));this.dropdown.css(w)},shouldOpen:function(){var e;if(this.opened()){return !1}e=T.Event("open");this.opts.element.trigger(e);return !e.isDefaultPrevented()},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above");this.dropdown.removeClass("select2-drop-above")},open:function(){if(!this.shouldOpen()){return !1}window.setTimeout(this.bind(this.opening),1);return !0},opening:function(){var f=this.containerId,e=this.containerSelector,i="scroll."+f,g="resize."+f;this.container.parents().each(function(){T(this).bind(i,function(){var l=T(e);0==l.length&&T(this).unbind(i);l.select2("close")})});T(window).bind(g,function(){var l=T(e);0==l.length&&T(window).unbind(g);l.select2("close")});this.clearDropdownAlignmentPreference();" "===this.search.val()&&this.search.val("");this.container.addClass("select2-dropdown-open").addClass("select2-container-active");this.updateResults(!0);this.dropdown[0]!==this.body().children().last()[0]&&this.dropdown.detach().appendTo(this.body());this.dropdown.show();this.positionDropdown();this.dropdown.addClass("select2-drop-active");this.ensureHighlightVisible();this.focusSearch()},close:function(){if(this.opened()){var e=this;this.container.parents().each(function(){T(this).unbind("scroll."+e.containerId)});T(window).unbind("resize."+this.containerId);this.clearDropdownAlignmentPreference();this.dropdown.hide();this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active");this.results.empty();this.clearSearch();this.opts.element.trigger(T.Event("close"))}},clearSearch:function(){},ensureHighlightVisible:function(){var g=this.results,e,m,l,i;m=this.highlight();0>m||(0==m?g.scrollTop(0):(e=g.find(".select2-result-selectable"),l=T(e[m]),i=l.offset().top+l.outerHeight(),m===e.length-1&&(e=g.find("li.select2-more-results"),0<e.length&&(i=e.offset().top+e.outerHeight())),e=g.offset().top+g.outerHeight(),i>e&&g.scrollTop(g.scrollTop()+(i-e)),l=l.offset().top-g.offset().top,0>l&&g.scrollTop(g.scrollTop()+l)))},moveHighlight:function(f){for(var e=this.results.find(".select2-result-selectable"),i=this.highlight();-1<i&&i<e.length;){var i=i+f,g=T(e[i]);if(g.hasClass("select2-result-selectable")&&!g.hasClass("select2-disabled")){this.highlight(i);break}}},highlight:function(f){var e=this.results.find(".select2-result-selectable").not(".select2-disabled");if(0===arguments.length){return Q(e.filter(".select2-highlighted")[0],e.get())}f>=e.length&&(f=e.length-1);0>f&&(f=0);e.removeClass("select2-highlighted");T(e[f]).addClass("select2-highlighted");this.ensureHighlightVisible()},countSelectableResults:function(){return this.results.find(".select2-result-selectable").not(".select2-disabled").length},highlightUnderEvent:function(f){f=T(f.target).closest(".select2-result-selectable");if(0<f.length&&!f.is(".select2-highlighted")){var e=this.results.find(".select2-result-selectable");this.highlight(e.index(f))}else{0==f.length&&this.results.find(".select2-highlighted").removeClass("select2-highlighted")}},loadMoreIfNeeded:function(){var l=this.results,i=l.find("li.select2-more-results"),v,u=this.resultsPage+1,s=this,q=this.search.val(),m=this.context;0!==i.length&&(v=i.offset().top-l.offset().top-l.height(),0>=v&&(i.addClass("select2-active"),this.opts.query({term:q,page:u,context:m,matcher:this.opts.matcher,callback:this.bind(function(e){s.opened()&&(s.opts.populateResults.call(this,l,e.results,{term:q,page:u,context:m}),!0===e.more?(i.detach().appendTo(l).text(s.opts.formatLoadMore(u+1)),window.setTimeout(function(){s.loadMoreIfNeeded()},10)):i.remove(),s.positionDropdown(),s.resultsPage=u)})})))},tokenize:function(){},updateResults:function(g){function e(){s.scrollTop(0);u.removeClass("select2-active");l.positionDropdown()}function v(f){s.html(l.opts.escapeMarkup(f));e()}var u=this.search,s=this.results,q=this.opts,m,l=this;if(!(!0!==g&&(!1===this.showSearchInput||!this.opened()))){u.addClass("select2-active");if(1<=q.maximumSelectionSize&&(m=this.data(),T.isArray(m)&&m.length>=q.maximumSelectionSize&&p(q.formatSelectionTooBig,"formatSelectionTooBig"))){v("<li class='select2-selection-limit'>"+q.formatSelectionTooBig(q.maximumSelectionSize)+"</li>");return}u.val().length<q.minimumInputLength&&p(q.formatInputTooShort,"formatInputTooShort")?v("<li class='select2-no-results'>"+q.formatInputTooShort(u.val(),q.minimumInputLength)+"</li>"):(v("<li class='select2-searching'>"+q.formatSearching()+"</li>"),m=this.tokenize(),m!=R&&null!=m&&u.val(m),this.resultsPage=1,q.query({term:u.val(),page:this.resultsPage,context:null,matcher:q.matcher,callback:this.bind(function(w){var f;this.opened()&&((this.context=w.context===R?null:w.context,this.opts.createSearchChoice&&""!==u.val()&&(f=this.opts.createSearchChoice.call(null,u.val(),w.results),f!==R&&null!==f&&l.id(f)!==R&&null!==l.id(f)&&0===T(w.results).filter(function(){return O(l.id(this),l.id(f))}).length&&w.results.unshift(f)),0===w.results.length&&p(q.formatNoMatches,"formatNoMatches"))?v("<li class='select2-no-results'>"+q.formatNoMatches(u.val())+"</li>"):(s.empty(),l.opts.populateResults.call(this,s,w.results,{term:u.val(),page:this.resultsPage,context:null}),!0===w.more&&p(q.formatLoadMore,"formatLoadMore")&&(s.append("<li class='select2-more-results'>"+l.opts.escapeMarkup(q.formatLoadMore(this.resultsPage))+"</li>"),window.setTimeout(function(){l.loadMoreIfNeeded()},10)),this.postprocessResults(w,g),e()))})}))}},cancel:function(){this.close()},blur:function(){this.close();this.container.removeClass("select2-container-active");this.dropdown.removeClass("select2-drop-active");this.search[0]===document.activeElement&&this.search.blur();this.clearSearch();this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){this.search.show();this.search.focus();window.setTimeout(this.bind(function(){this.search.show();this.search.focus();this.search.val(this.search.val())}),10)},selectHighlighted:function(){var f=this.highlight(),e=this.results.find(".select2-highlighted").not(".select2-disabled"),g=e.closest(".select2-result-selectable").data("select2-data");g&&(e.addClass("select2-disabled"),this.highlight(f),this.onSelect(g))},getPlaceholder:function(){return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder},initContainerWidth:function(){var e=function(){var g,m,l,i;if("off"===this.opts.width){return null}if("element"===this.opts.width){return 0===this.opts.element.outerWidth()?"auto":this.opts.element.outerWidth()+"px"}if("copy"===this.opts.width||"resolve"===this.opts.width){g=this.opts.element.attr("style");if(g!==R){g=g.split(";");l=0;for(i=g.length;l<i;l+=1){if(m=g[l].replace(/\s/g,"").match(/width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/),null!==m&&1<=m.length){return m[1]}}}return"resolve"===this.opts.width?(g=this.opts.element.css("width"),0<g.indexOf("%")?g:0===this.opts.element.outerWidth()?"auto":this.opts.element.outerWidth()+"px"):null}return T.isFunction(this.opts.width)?this.opts.width():this.opts.width}.call(this);null!==e&&this.container.attr("style","width: "+e)}});b=d(h,{createContainer:function(){return T("<div></div>",{"class":"select2-container"}).html("    <a href='#' onclick='return false;' class='select2-choice'>   <span></span><abbr class='select2-search-choice-close' style='display:none;'></abbr>   <div><b></b></div></a>    <div class='select2-drop select2-offscreen'>   <div class='select2-search'>       <input type='text' autocomplete='off' class='select2-input'/>   </div>   <ul class='select2-results'>   </ul></div>")},opening:function(){this.search.show();this.parent.opening.apply(this,arguments);this.dropdown.removeClass("select2-offscreen")},close:function(){this.opened()&&(this.parent.close.apply(this,arguments),this.dropdown.removeAttr("style").addClass("select2-offscreen").insertAfter(this.selection).show())},focus:function(){this.close();this.selection.focus()},isFocused:function(){return this.selection[0]===document.activeElement},cancel:function(){this.parent.cancel.apply(this,arguments);this.selection.focus()},initContainer:function(){var f,e=this.dropdown;this.selection=f=this.container.find(".select2-choice");this.search.bind("keydown",this.bind(function(g){if(this.enabled){if(g.which===S.PAGE_UP||g.which===S.PAGE_DOWN){P(g)}else{if(this.opened()){switch(g.which){case S.UP:case S.DOWN:this.moveHighlight(g.which===S.UP?-1:1);P(g);break;case S.TAB:case S.ENTER:this.selectHighlighted();P(g);break;case S.ESC:this.cancel(g),P(g)}}else{g.which===S.TAB||S.isControl(g)||S.isFunctionKey(g)||g.which===S.ESC||!1===this.opts.openOnEnter&&g.which===S.ENTER||this.open()}}}}));this.search.bind("focus",this.bind(function(){this.selection.attr("tabIndex","-1")}));this.search.bind("blur",this.bind(function(){this.opened()||this.container.removeClass("select2-container-active");window.setTimeout(this.bind(function(){this.selection.attr("tabIndex",this.opts.element.attr("tabIndex"))}),10)}));f.bind("mousedown",this.bind(function(){this.opened()?(this.close(),this.selection.focus()):this.enabled&&this.open()}));e.bind("mousedown",this.bind(function(){this.search.focus()}));f.bind("focus",this.bind(function(){this.container.addClass("select2-container-active");this.search.attr("tabIndex","-1")}));f.bind("blur",this.bind(function(){this.opened()||this.container.removeClass("select2-container-active");window.setTimeout(this.bind(function(){this.search.attr("tabIndex",this.opts.element.attr("tabIndex"))}),10)}));f.bind("keydown",this.bind(function(i){if(this.enabled){if(i.which===S.PAGE_UP||i.which===S.PAGE_DOWN){P(i)}else{if(!(i.which===S.TAB||S.isControl(i)||S.isFunctionKey(i)||i.which===S.ESC)&&!(!1===this.opts.openOnEnter&&i.which===S.ENTER)){if(i.which==S.DELETE){this.opts.allowClear&&this.clear()}else{this.open();if(i.which!==S.ENTER&&!(48>i.which)){var g=String.fromCharCode(i.which).toLowerCase();i.shiftKey&&(g=g.toUpperCase());this.search.focus();this.search.val(g)}P(i)}}}}}));f.delegate("abbr","mousedown",this.bind(function(g){this.enabled&&(this.clear(),P(g),this.close(),this.triggerChange(),this.selection.focus())}));this.setPlaceholder();this.search.bind("focus",this.bind(function(){this.container.addClass("select2-container-active")}))},clear:function(){this.opts.element.val("");this.selection.find("span").empty();this.selection.removeData("select2-data");this.setPlaceholder()},initSelection:function(){if(""===this.opts.element.val()){this.close(),this.setPlaceholder()}else{var e=this;this.opts.initSelection.call(null,this.opts.element,function(f){f!==R&&null!==f&&(e.updateSelection(f),e.close(),e.setPlaceholder())})}},prepareOpts:function(){var e=this.parent.prepareOpts.apply(this,arguments);"select"===e.element.get(0).tagName.toLowerCase()&&(e.initSelection=function(f,i){var g=f.find(":selected");T.isFunction(i)&&i({id:g.attr("value"),text:g.text()})});return e},setPlaceholder:function(){var e=this.getPlaceholder();""===this.opts.element.val()&&e!==R&&!(this.select&&""!==this.select.find("option:first").text())&&(this.selection.find("span").html(this.opts.escapeMarkup(e)),this.selection.addClass("select2-default"),this.selection.find("abbr").hide())},postprocessResults:function(g,e){var m=0,l=this,i=!0;this.results.find(".select2-result-selectable").each2(function(q,f){if(O(l.id(f.data("select2-data")),l.opts.element.val())){return m=q,!1}});this.highlight(m);!0===e&&(i=this.showSearchInput=o(g.results)>=this.opts.minimumResultsForSearch,this.dropdown.find(".select2-search")[i?"removeClass":"addClass"]("select2-search-hidden"),T(this.dropdown,this.container)[i?"addClass":"removeClass"]("select2-with-searchbox"))},onSelect:function(f){var e=this.opts.element.val();this.opts.element.val(this.id(f));this.updateSelection(f);this.close();this.selection.focus();O(e,this.id(f))||this.triggerChange()},updateSelection:function(f){var e=this.selection.find("span");this.selection.data("select2-data",f);e.empty();f=this.opts.formatSelection(f,e);f!==R&&e.append(this.opts.escapeMarkup(f));this.selection.removeClass("select2-default");this.opts.allowClear&&this.getPlaceholder()!==R&&this.selection.find("abbr").show()},val:function(){var f,e=null,g=this;if(0===arguments.length){return this.opts.element.val()}f=arguments[0];if(this.select){this.select.val(f).find(":selected").each2(function(i,l){e={id:l.attr("value"),text:l.text()};return !1}),this.updateSelection(e),this.setPlaceholder()}else{if(this.opts.initSelection===R){throw Error("cannot call val() if initSelection() is not defined")}f?(this.opts.element.val(f),this.opts.initSelection(this.opts.element,function(i){g.opts.element.val(!i?"":g.id(i));g.updateSelection(i);g.setPlaceholder()})):this.clear()}},clearSearch:function(){this.search.val("")},data:function(f){var e;if(0===arguments.length){return e=this.selection.data("select2-data"),e==R&&(e=null),e}!f||""===f?this.clear():(this.opts.element.val(!f?"":this.id(f)),this.updateSelection(f))}});a=d(h,{createContainer:function(){return T("<div></div>",{"class":"select2-container select2-container-multi"}).html("    <ul class='select2-choices'>  <li class='select2-search-field'>    <input type='text' autocomplete='off' class='select2-input'>  </li></ul><div class='select2-drop select2-drop-multi' style='display:none;'>   <ul class='select2-results'>   </ul></div>")},prepareOpts:function(){var e=this.parent.prepareOpts.apply(this,arguments);"select"===e.element.get(0).tagName.toLowerCase()&&(e.initSelection=function(f,i){var g=[];f.find(":selected").each2(function(m,l){g.push({id:l.attr("value"),text:l.text()})});T.isFunction(i)&&i(g)});return e},initContainer:function(){var e;this.searchContainer=this.container.find(".select2-search-field");this.selection=e=this.container.find(".select2-choices");this.search.bind("keydown",this.bind(function(f){if(this.enabled){if(f.which===S.BACKSPACE&&""===this.search.val()){this.close();var g;g=e.find(".select2-search-choice-focus");if(0<g.length){this.unselect(g.first());this.search.width(10);P(f);return}g=e.find(".select2-search-choice");0<g.length&&g.last().addClass("select2-search-choice-focus")}else{e.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")}if(this.opened()){switch(f.which){case S.UP:case S.DOWN:this.moveHighlight(f.which===S.UP?-1:1);P(f);return;case S.ENTER:case S.TAB:this.selectHighlighted();P(f);return;case S.ESC:this.cancel(f);P(f);return}}if(!(f.which===S.TAB||S.isControl(f)||S.isFunctionKey(f)||f.which===S.BACKSPACE||f.which===S.ESC)&&!(!1===this.opts.openOnEnter&&f.which===S.ENTER)){this.open(),(f.which===S.PAGE_UP||f.which===S.PAGE_DOWN)&&P(f)}}}));this.search.bind("keyup",this.bind(this.resizeSearch));this.search.bind("blur",this.bind(function(f){this.container.removeClass("select2-container-active");this.search.removeClass("select2-focused");this.clearSearch();f.stopImmediatePropagation()}));this.container.delegate(".select2-choices","mousedown",this.bind(function(f){this.enabled&&!(0<T(f.target).closest(".select2-search-choice").length)&&(this.clearPlaceholder(),this.open(),this.focusSearch(),f.preventDefault())}));this.container.delegate(".select2-choices","focus",this.bind(function(){this.enabled&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder())}));this.clearSearch()},enable:function(){this.enabled||(this.parent.enable.apply(this,arguments),this.search.removeAttr("disabled"))},disable:function(){this.enabled&&(this.parent.disable.apply(this,arguments),this.search.attr("disabled",!0))},initSelection:function(){""===this.opts.element.val()&&(this.updateSelection([]),this.close(),this.clearSearch());if(this.select||""!==this.opts.element.val()){var e=this;this.opts.initSelection.call(null,this.opts.element,function(f){if(f!==R&&f!==null){e.updateSelection(f);e.close();e.clearSearch()}})}},clearSearch:function(){var e=this.getPlaceholder();e!==R&&0===this.getVal().length&&!1===this.search.hasClass("select2-focused")?(this.search.val(e).addClass("select2-default"),this.resizeSearch()):this.search.val(" ").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")?this.search.val("").removeClass("select2-default"):" "===this.search.val()&&this.search.val("")},opening:function(){this.parent.opening.apply(this,arguments);this.clearPlaceholder();this.resizeSearch();this.focusSearch()},close:function(){this.opened()&&this.parent.close.apply(this,arguments)},focus:function(){this.close();this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(f){var e=[],i=[],g=this;T(f).each(function(){0>Q(g.id(this),e)&&(e.push(g.id(this)),i.push(this))});f=i;this.selection.find(".select2-search-choice").remove();T(f).each(function(){g.addSelectedChoice(this)});g.postprocessResults()},tokenize:function(){var e=this.search.val(),e=this.opts.tokenizer(e,this.data(),this.bind(this.onSelect),this.opts);null!=e&&e!=R&&(this.search.val(e),0<e.length&&this.open())},onSelect:function(e){this.addSelectedChoice(e);this.select&&this.postprocessResults();this.opts.closeOnSelect?(this.close(),this.search.width(10)):0<this.countSelectableResults()?(this.search.width(10),this.resizeSearch(),this.positionDropdown()):this.close();this.triggerChange({added:e});this.focusSearch()},cancel:function(){this.close();this.focusSearch()},addSelectedChoice:function(g){var e=T("<li class='select2-search-choice'>    <div></div>    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a></li>"),m=this.id(g),l=this.getVal(),i;i=this.opts.formatSelection(g,e);e.find("div").replaceWith("<div>"+this.opts.escapeMarkup(i)+"</div>");e.find(".select2-search-choice-close").bind("mousedown",P).bind("click dblclick",this.bind(function(f){this.enabled&&(T(f.target).closest(".select2-search-choice").fadeOut("fast",this.bind(function(){this.unselect(T(f.target));this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");this.close();this.focusSearch()})).dequeue(),P(f))})).bind("focus",this.bind(function(){this.enabled&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"))}));e.data("select2-data",g);e.insertBefore(this.searchContainer);l.push(m);this.setVal(l)},unselect:function(f){var e=this.getVal(),i,g,f=f.closest(".select2-search-choice");if(0===f.length){throw"Invalid argument: "+f+". Must be .select2-search-choice"}i=f.data("select2-data");g=Q(this.id(i),e);0<=g&&(e.splice(g,1),this.setVal(e),this.select&&this.postprocessResults());f.remove();this.triggerChange({removed:i})},postprocessResults:function(){var f=this.getVal(),e=this.results.find(".select2-result-selectable"),i=this.results.find(".select2-result-with-children"),g=this;e.each2(function(l,q){var m=g.id(q.data("select2-data"));0<=Q(m,f)?q.addClass("select2-disabled").removeClass("select2-result-selectable"):q.removeClass("select2-disabled").addClass("select2-result-selectable")});i.each2(function(m,l){0==l.find(".select2-result-selectable").length?l.addClass("select2-disabled"):l.removeClass("select2-disabled")});e.each2(function(m,l){if(!l.hasClass("select2-disabled")&&l.hasClass("select2-result-selectable")){return g.highlight(0),!1}})},resizeSearch:function(){var g,e,m,l,i=this.search.outerWidth()-this.search.width();g=this.search;L||(m=g[0].currentStyle||window.getComputedStyle(g[0],null),L=T("<div></div>").css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:m.fontSize,fontFamily:m.fontFamily,fontStyle:m.fontStyle,fontWeight:m.fontWeight,letterSpacing:m.letterSpacing,textTransform:m.textTransform,whiteSpace:"nowrap"}),T("body").append(L));L.text(g.val());g=L.width()+10;e=this.search.offset().left;m=this.selection.width();l=this.selection.offset().left;e=m-(e-l)-i;e<g&&(e=m-i);40>e&&(e=m-i);this.search.width(e)},getVal:function(){var e;if(this.select){return e=this.select.val(),null===e?[]:e}e=this.opts.element.val();return t(e,this.opts.separator)},setVal:function(f){var e;this.select?this.select.val(f):(e=[],T(f).each(function(){0>Q(this,e)&&e.push(this)}),this.opts.element.val(0===e.length?"":e.join(this.opts.separator)))},val:function(){var f,e=[],g=this;if(0===arguments.length){return this.getVal()}if(f=arguments[0]){if(this.setVal(f),this.select){this.select.find(":selected").each(function(){e.push({id:T(this).attr("value"),text:T(this).text()})}),this.updateSelection(e)}else{if(this.opts.initSelection===R){throw Error("val() cannot be called if initSelection() is not defined")}this.opts.initSelection(this.opts.element,function(l){var i=T(l).map(g.id);g.setVal(i);g.updateSelection(l);g.clearSearch()})}}else{this.opts.element.val(""),this.updateSelection([])}this.clearSearch()},onSortStart:function(){if(this.select){throw Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.")}this.search.width(0);this.searchContainer.hide()},onSortEnd:function(){var f=[],e=this;this.searchContainer.show();this.searchContainer.appendTo(this.searchContainer.parent());this.resizeSearch();this.selection.find(".select2-search-choice").each(function(){f.push(e.opts.id(T(this).data("select2-data")))});this.setVal(f);this.triggerChange()},data:function(f){var e=this,g;if(0===arguments.length){return this.selection.find(".select2-search-choice").map(function(){return T(this).data("select2-data")}).get()}f||(f=[]);g=T.map(f,function(i){return e.opts.id(i)});this.setVal(g);this.updateSelection(f);this.clearSearch()}});T.fn.select2=function(){var g=Array.prototype.slice.call(arguments,0),e,q,m,l,i="val destroy opened open close focus isFocused container onSortStart onSortEnd enable disable positionDropdown data".split(" ");this.each(function(){if(0===g.length||"object"===typeof g[0]){e=0===g.length?{}:T.extend({},g[0]),e.element=T(this),"select"===e.element.get(0).tagName.toLowerCase()?l=e.element.attr("multiple"):(l=e.multiple||!1,"tags" in e&&(e.multiple=l=!0)),q=l?new a:new b,q.init(e)}else{if("string"===typeof g[0]){if(0>Q(g[0],i)){throw"Unknown method: "+g[0]}m=R;q=T(this).data("select2");if(q!==R&&(m="container"===g[0]?q.container:q[g[0]].apply(q,g.slice(1)),m!==R)){return !1}}else{throw"Invalid arguments to select2 plugin: "+g}}});return m===R?this:m};T.fn.select2.defaults={width:"copy",closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(f,e,g){e=[];M(f.text,g.term,e);return e.join("")},formatSelection:function(e){return e?e.text:R},formatResultCssClass:function(){return R},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(f,e){return"Please enter "+(e-f.length)+" more characters"},formatSelectionTooBig:function(e){return"You can only select "+e+" item"+(1==e?"":"s")},formatLoadMore:function(){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumResultsForSearch:0,minimumInputLength:0,maximumSelectionSize:0,id:function(e){return e.id},matcher:function(f,e){return 0<=e.toUpperCase().indexOf(f.toUpperCase())},separator:",",tokenSeparators:[],tokenizer:j,escapeMarkup:function(e){return e&&"string"===typeof e?e.replace(/&/g,"&amp;"):e},blurOnChange:!1};window.Select2={query:{ajax:K,local:J,tags:r},util:{debounce:N,markMatch:M},"class":{"abstract":h,single:b,multi:a}}}})(jQuery);